<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extensions PHP pour VS Code | Cours Web Development</title>
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/html.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
    <script>hljs.highlightAll();</script>
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Extensions PHP pour VS Code | Cours Web Development</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Extensions PHP pour VS Code" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Support de cours pour le dÃ©veloppement web" />
<meta property="og:description" content="Support de cours pour le dÃ©veloppement web" />
<link rel="canonical" href="http://localhost:4000/php/php-advanced.html" />
<meta property="og:url" content="http://localhost:4000/php/php-advanced.html" />
<meta property="og:site_name" content="Cours Web Development" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Extensions PHP pour VS Code" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Support de cours pour le dÃ©veloppement web","headline":"Extensions PHP pour VS Code","url":"http://localhost:4000/php/php-advanced.html"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
    <div class="site-content">
    <h1 id="support-de-cours--php-avanc">Support de cours : PHP AvancÃ©</h1>
<div style="text-align: center;">
    <img src="../img/php200.png" alt="Logo PHP">
</div>
<p>Bienvenue dans le cours <strong>PHP AvancÃ©</strong> !</p>
<p>Ce cours sâ€™adresse aux apprenants ayant suivi Introduction Ã  PHP ou possÃ©dant des bases solides (variables, fonctions, formulaires, MySQL, sessions). Vous apprendrez des techniques modernes : <strong>architecture MVC, ORM avec Eloquent (Laravel), sÃ©curitÃ© (XSS, CSRF), API REST</strong>, et <strong>outils (Composer, PHPUnit</strong>). Ã€ travers des exercices complexes et un projet en groupe (application de gestion dâ€™utilisateurs), vous serez prÃªt Ã  dÃ©velopper des applications backend robustes et sÃ©curisÃ©es.</p>
<h3 id="objectifs-du-cours">Objectifs du cours</h3>
<ul>
<li>MaÃ®triser lâ€™<strong>architecture MVC</strong> avec Laravel.</li>
<li>Utiliser <strong>Eloquent</strong> pour interagir avec une base de donnÃ©es.</li>
<li>ImplÃ©menter des pratiques de <strong>sÃ©curitÃ©</strong> (validation, protection XSS/CSRF).</li>
<li>DÃ©velopper une <strong>API REST</strong> avec Laravel.</li>
<li>Configurer des <strong>outils</strong> comme Composer et PHPUnit pour tests unitaires.</li>
<li>DÃ©velopper un projet en groupe : une application de gestion dâ€™utilisateurs.</li>
</ul>
<h3 id="prrequis">PrÃ©requis</h3>
<ul>
<li><strong>Connaissances</strong> :
<ul>
<li>MaÃ®trise de PHP (voir Introduction Ã  PHP).</li>
<li>FamiliaritÃ© avec MySQL, formulaires, sessions, et GET/POST.</li>
<li>Notions de base sur HTML/CSS/JS (voir Introduction Ã  HTML, CSS et JavaScript).</li>
</ul>
</li>
<li>Outils :
<ul>
<li><a href="">Visual Studio Code</a> avec extensions PHP, Laravel.</li>
<li><a href="">PHP</a> (version 8.1+ recommandÃ©e).</li>
<li><a href="">Composer</a> pour gÃ©rer les dÃ©pendances.</li>
<li><a href="">MySQL</a> ou <a href="">MariaDB</a>.</li>
<li><a href="">Laravel</a> (installÃ© via Composer).</li>
<li>Navigateur moderne (Chrome, Firefox) avec outils de dÃ©veloppement.</li>
<li>Compte GitHub pour soumettre vos travaux (voir Introduction Ã  GitHub).</li>
</ul>
</li>
<li>Temps estimÃ© : 12-15 heures (lectures, exercices, projet).</li>
</ul>
<h3 id="structure-du-cours">Structure du cours</h3>
<p><strong>Partie 1 : Architecture MVC et Eloquent</strong></p>
<p><strong>Partie 2 : SÃ©curitÃ© et validation</strong></p>
<p><strong>Partie 3 : API REST et tests avec PHPUnit</strong></p>
<p><strong>Partie 4 : Projet en groupe â€“ Application de gestion dâ€™utilisateurs</strong></p>
<hr />
<h1 id="partie-1--architecture-mvc-et-eloquent">Partie 1 : Architecture MVC et Eloquent</h1>
<h1 id="comprendre-larchitecture-mvc-model-view-controller">ğŸ§  Comprendre lâ€™Architecture MVC (Model-View-Controller)</h1>
<p>Lâ€™architecture <strong>MVC</strong> est une maniÃ¨re dâ€™organiser le code dâ€™une application web pour le rendre <strong>plus clair, structurÃ© et maintenable</strong>.</p>
<p>Elle se compose de <strong>trois couches</strong> principales :</p>
<table>
<thead>
<tr>
<th>Composant</th>
<th>RÃ´le</th>
<th>Exemple Laravel</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Model</strong></td>
<td>GÃ¨re les <strong>donnÃ©es</strong> (accÃ¨s Ã  la base, logique mÃ©tier)</td>
<td><code>app/Models/User.php</code></td>
</tr>
<tr>
<td><strong>View</strong></td>
<td>Affiche lâ€™<strong>interface utilisateur</strong> (HTML + donnÃ©es dynamiques)</td>
<td><code>resources/views/users/index.blade.php</code></td>
</tr>
<tr>
<td><strong>Controller</strong></td>
<td>GÃ¨re les <strong>actions de lâ€™utilisateur</strong> et <strong>relie</strong> Model + View</td>
<td><code>app/Http/Controllers/UserController.php</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="comment-fonctionne-mvc-">ğŸ” Comment fonctionne MVC ?</h2>
<ol>
<li><strong>Lâ€™utilisateur</strong> accÃ¨de Ã  une URL (ex : <code>/users</code>).</li>
<li><strong>Le routeur</strong> appelle la mÃ©thode correspondante dans un <strong>contrÃ´leur</strong>.</li>
<li>Le <strong>contrÃ´leur</strong> :
<ul>
<li>rÃ©cupÃ¨re les donnÃ©es via le <strong>modÃ¨le</strong> (ex : <code>User::all()</code>),</li>
<li>les transmet Ã  une <strong>vue</strong> (ex : <code>users.index</code>).</li>
</ul>
</li>
<li>La <strong>vue</strong> affiche les donnÃ©es Ã  lâ€™Ã©cran.</li>
</ol>
<hr />
<h2 id="mise-en-pratique-avec-laravel">ğŸš€ Mise en pratique avec Laravel</h2>
<h3 id="cration-du-projet">1. CrÃ©ation du projet</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>composer create-project laravel/laravel user-management
<span class="nb">cd </span>user-management
php artisan serve
</code></pre></div></div>
<blockquote>
<p>Cela crÃ©e la structure du projet Laravel, et lance un serveur local sur <a href="http://localhost:8000">http://localhost:8000</a>.</p>
</blockquote>
<hr />
<h3 id="gnrer-le-modle-le-contrleur-et-la-migration-">2. GÃ©nÃ©rer le modÃ¨le, le contrÃ´leur et la migration :</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php artisan make:model User <span class="nt">-mcr</span>
</code></pre></div></div>
<ul>
<li><code>User</code> est le nom du <strong>modÃ¨le</strong>.</li>
<li><code>-m</code> : crÃ©e une <strong>migration</strong> (structure de la table <code>users</code>).</li>
<li><code>-c</code> : crÃ©e un <strong>contrÃ´leur</strong>.</li>
<li><code>-r</code> : le contrÃ´leur sera <strong>RESTful</strong> (avec les mÃ©thodes <code>index</code>, <code>create</code>, <code>store</code>, etc.)</li>
</ul>
<hr />
<h3 id="exemple-de-contrleur">3. Exemple de ContrÃ´leur</h3>
<p>ğŸ“„ <code>app/Http/Controllers/UserController.php</code></p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">namespace</span> <span class="nn">App\Http\Controllers</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">App\Models\User</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Illuminate\Http\Request</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">UserController</span> <span class="kd">extends</span> <span class="nc">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">index</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$users</span> <span class="o">=</span> <span class="nc">User</span><span class="o">::</span><span class="nf">all</span><span class="p">();</span> <span class="c1">// Appel au Model</span>
        <span class="k">return</span> <span class="nf">view</span><span class="p">(</span><span class="s1">'users.index'</span><span class="p">,</span> <span class="nb">compact</span><span class="p">(</span><span class="s1">'users'</span><span class="p">));</span> <span class="c1">// Transmission Ã  la View</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<hr />
<h3 id="exemple-de-vue">4. Exemple de Vue</h3>
<p>ğŸ“„ <code>resources/views/users/index.blade.php</code></p>
<pre><code class="language-blade">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Utilisateurs&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Liste des utilisateurs&lt;/h1&gt;
    &lt;ul&gt;
        @foreach ($users as $user)
            &lt;li&gt;{{ $user-&gt;name }}&lt;/li&gt;
        @endforeach
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<hr />
<h3 id="ajouter-une-route-dans-coderouteswebphpcode">5. Ajouter une route dans <code>routes/web.php</code></h3>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">App\Http\Controllers\UserController</span><span class="p">;</span>

<span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/users'</span><span class="p">,</span> <span class="p">[</span><span class="nc">UserController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'index'</span><span class="p">]);</span>
</code></pre></div></div>
<blockquote>
<p>En accÃ©dant Ã  <code>http://localhost:8000/users</code>, Laravel appelle <code>UserController@index</code> qui rÃ©cupÃ¨re les utilisateurs et les envoie Ã  la vue <code>users.index</code>.</p>
</blockquote>
<hr />
<h2 id="rsum-pdagogique">ğŸ“Œ RÃ©sumÃ© pÃ©dagogique</h2>
<table>
<thead>
<tr>
<th>Ã‰lÃ©ment</th>
<th>Emplacement</th>
<th>Fonction</th>
</tr>
</thead>
<tbody>
<tr>
<td>Model</td>
<td><code>app/Models/User.php</code></td>
<td>ReprÃ©sente la table <code>users</code>, interagit avec la base</td>
</tr>
<tr>
<td>View</td>
<td><code>resources/views/users/index.blade.php</code></td>
<td>Affiche les utilisateurs</td>
</tr>
<tr>
<td>Controller</td>
<td><code>app/Http/Controllers/UserController.php</code></td>
<td>Coordonne lâ€™affichage et les donnÃ©es</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="eloquent-orm">ğŸ§© Eloquent ORM</h2>
<p><strong>Eloquent</strong> est lâ€™ORM (Object Relational Mapper) intÃ©grÃ© de Laravel.<br />
Il permet de manipuler les donnÃ©es de la base <strong>en utilisant des objets PHP</strong>, sans Ã©crire de requÃªtes SQL brutes.</p>
<hr />
<h3 id="exemple--dfinir-un-modle">ğŸ›  Exemple : DÃ©finir un modÃ¨le</h3>
<p>ğŸ“„ <code>app/Models/User.php</code></p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">namespace</span> <span class="nn">App\Models</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">User</span> <span class="kd">extends</span> <span class="nc">Model</span>
<span class="p">{</span>
    <span class="c1">// Champs autorisÃ©s Ã  lâ€™insertion/mise Ã  jour en masse</span>
    <span class="k">protected</span> <span class="nv">$fillable</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'email'</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div></div>
<blockquote>
<p><code>fillable</code> empÃªche les failles de type &quot;Mass Assignment&quot; en ne permettant que certains champs Ã  Ãªtre remplis lors dâ€™un enregistrement ou dâ€™une mise Ã  jour.</p>
</blockquote>
<hr />
<h3 id="rcuprer-des-utilisateurs-avec-eloquent">ğŸ” RÃ©cupÃ©rer des utilisateurs avec Eloquent</h3>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$users</span> <span class="o">=</span> <span class="nc">User</span><span class="o">::</span><span class="nf">where</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'like'</span><span class="p">,</span> <span class="s1">'%John%'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">();</span>
</code></pre></div></div>
<blockquote>
<p>Cela renvoie tous les utilisateurs dont le nom contient &quot;John&quot;.</p>
</blockquote>
<hr />
<h3 id="autres-exemples-utiles">ğŸ“˜ Autres exemples utiles</h3>
<h4 id="crer-un-utilisateur">ğŸ”¹ CrÃ©er un utilisateur</h4>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">User</span><span class="o">::</span><span class="nf">create</span><span class="p">([</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Jean Dupont'</span><span class="p">,</span>
    <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'jean@example.com'</span><span class="p">,</span>
<span class="p">]);</span>
</code></pre></div></div>
<h4 id="trouver-un-utilisateur-par-id">ğŸ”¹ Trouver un utilisateur par ID</h4>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">::</span><span class="nf">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</code></pre></div></div>
<h4 id="mettre--jour-un-utilisateur">ğŸ”¹ Mettre Ã  jour un utilisateur</h4>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">::</span><span class="nf">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="nf">update</span><span class="p">([</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Jean ModifiÃ©'</span><span class="p">]);</span>
</code></pre></div></div>
<h4 id="supprimer-un-utilisateur">ğŸ”¹ Supprimer un utilisateur</h4>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">::</span><span class="nf">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="nb">delete</span><span class="p">();</span>
</code></pre></div></div>
<hr />
<h2 id="rsum-pdagogique-1">ğŸ§  RÃ©sumÃ© pÃ©dagogique</h2>
<table>
<thead>
<tr>
<th>Action</th>
<th>Code Eloquent</th>
<th>Equivalent SQL</th>
</tr>
</thead>
<tbody>
<tr>
<td>Lire tous les users</td>
<td><code>User::all()</code></td>
<td><code>SELECT * FROM users;</code></td>
</tr>
<tr>
<td>Lire avec filtre</td>
<td><code>User::where('name', 'like', '%John%')-&gt;get()</code></td>
<td><code>SELECT * FROM users WHERE name LIKE '%John%';</code></td>
</tr>
<tr>
<td>CrÃ©er</td>
<td><code>User::create([...])</code></td>
<td><code>INSERT INTO users (...) VALUES (...);</code></td>
</tr>
<tr>
<td>Modifier</td>
<td><code>$user-&gt;update([...])</code></td>
<td><code>UPDATE users SET ... WHERE id = ...;</code></td>
</tr>
<tr>
<td>Supprimer</td>
<td><code>$user-&gt;delete()</code></td>
<td><code>DELETE FROM users WHERE id = ...;</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>âœ¨ Avec Eloquent, on travaille <strong>directement avec des objets</strong> plutÃ´t qu'avec des lignes SQL, ce qui rend le code plus lisible, rÃ©utilisable et sÃ»r.</p>
</blockquote>
<h2 id="exercices-">Exercices :</h2>
<p><strong>Ã€ vous de jouer</strong> <a href="/php/exercises/exercices-advanced1.1.html">Exercices</a></p>
<hr />
<h2 id="partie-2--scurit-et-validation">ğŸ›¡ï¸ Partie 2 : SÃ©curitÃ© et validation</h2>
<h3 id="scurit-dans-laravel">ğŸ”’ SÃ©curitÃ© dans Laravel</h3>
<p>Laravel propose plusieurs mÃ©canismes intÃ©grÃ©s pour protÃ©ger votre application web :</p>
<table>
<thead>
<tr>
<th>Type d'attaque</th>
<th>Protection dans Laravel</th>
<th>Explication</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>XSS</strong> (Cross-Site Scripting)</td>
<td><code>{{ $variable }}</code></td>
<td>Ã‰chappe automatiquement le HTML pour Ã©viter lâ€™injection de scripts</td>
</tr>
<tr>
<td><strong>CSRF</strong> (Cross-Site Request Forgery)</td>
<td><code>@csrf</code></td>
<td>GÃ©nÃ¨re un token CSRF dans les formulaires pour bloquer les requÃªtes non autorisÃ©es</td>
</tr>
<tr>
<td><strong>Injection SQL</strong></td>
<td>Eloquent ORM ou Query Builder</td>
<td>Utilise des requÃªtes prÃ©parÃ©es automatiquement</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="exemple-de-formulaire-scuris">âœ… Exemple de formulaire sÃ©curisÃ©</h3>
<pre><code class="language-blade">&lt;form method=&quot;POST&quot; action=&quot;/users&quot;&gt;
    @csrf
    &lt;input type=&quot;text&quot; name=&quot;name&quot; required&gt;
    &lt;input type=&quot;email&quot; name=&quot;email&quot; required&gt;
    &lt;button type=&quot;submit&quot;&gt;Ajouter&lt;/button&gt;
&lt;/form&gt;
</code></pre>
<blockquote>
<p>Ce formulaire est sÃ©curisÃ© contre les attaques CSRF et XSS grÃ¢ce aux protections automatiques de Laravel.</p>
</blockquote>
<hr />
<h2 id="validation">âœ… Validation</h2>
<p>Laravel permet de <strong>valider les donnÃ©es cÃ´tÃ© serveur</strong> trÃ¨s facilement via la mÃ©thode <code>validate()</code> sur lâ€™objet <code>Request</code>.</p>
<hr />
<h3 id="exemple-de-validation-dans-un-contrleur">ğŸ“„ Exemple de validation dans un contrÃ´leur</h3>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// app/Http/Controllers/UserController.php</span>

<span class="k">public</span> <span class="k">function</span> <span class="n">store</span><span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$validated</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">validate</span><span class="p">([</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required|string|max:255'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'required|email|unique:users,email'</span><span class="p">,</span>
    <span class="p">]);</span>

    <span class="nc">User</span><span class="o">::</span><span class="nf">create</span><span class="p">(</span><span class="nv">$validated</span><span class="p">);</span>

    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="s1">'/users'</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<blockquote>
<p>Si la validation Ã©choue, Laravel <strong>redirige automatiquement</strong> vers le formulaire avec les <strong>messages dâ€™erreurs</strong> prÃªts Ã  afficher.</p>
</blockquote>
<hr />
<h3 id="rgles-de-validation-courantes">ğŸ“Œ RÃ¨gles de validation courantes</h3>
<table>
<thead>
<tr>
<th>RÃ¨gle</th>
<th>Signification</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>required</code></td>
<td>Le champ est obligatoire</td>
</tr>
<tr>
<td><code>string</code></td>
<td>Le champ doit Ãªtre une chaÃ®ne de caractÃ¨res</td>
</tr>
<tr>
<td><code>email</code></td>
<td>Doit Ãªtre un email valide</td>
</tr>
<tr>
<td><code>unique:table,column</code></td>
<td>Doit Ãªtre unique dans la table</td>
</tr>
<tr>
<td><code>max:255</code></td>
<td>Longueur maximale de 255 caractÃ¨res</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="exercice-21--formulaire-scuris">ğŸ¯ Exercice 2.1 : Formulaire sÃ©curisÃ©</h3>
<p>CrÃ©ez un formulaire dâ€™ajout dâ€™utilisateur avec :</p>
<ul>
<li>Un champ <code>name</code> obligatoire.</li>
<li>Un champ <code>email</code> obligatoire, valide, et unique.</li>
<li>Protection CSRF.</li>
<li>Validation dans le contrÃ´leur.</li>
<li>Affichage des erreurs dans la vue si la validation Ã©choue.</li>
</ul>
<pre><code class="language-blade">&lt;!-- resources/views/users/create.blade.php --&gt;
&lt;form method=&quot;POST&quot; action=&quot;/users&quot;&gt;
    @csrf

    &lt;label&gt;Nom&lt;/label&gt;
    &lt;input type=&quot;text&quot; name=&quot;name&quot; value=&quot;{{ old('name') }}&quot;&gt;
    @error('name')
        &lt;div&gt;{{ $message }}&lt;/div&gt;
    @enderror

    &lt;label&gt;Email&lt;/label&gt;
    &lt;input type=&quot;email&quot; name=&quot;email&quot; value=&quot;{{ old('email') }}&quot;&gt;
    @error('email')
        &lt;div&gt;{{ $message }}&lt;/div&gt;
    @enderror

    &lt;button type=&quot;submit&quot;&gt;Enregistrer&lt;/button&gt;
&lt;/form&gt;
</code></pre>
<hr />
<blockquote>
<p>ğŸ’¡ Utilisez <code>old('field')</code> pour <strong>prÃ©remplir les champs</strong> aprÃ¨s une validation Ã©chouÃ©e, et <code>@error('field')</code> pour afficher les messages dâ€™erreurs.</p>
</blockquote>
<hr />
<h2 id="partie-22--gestion-des-erreurs-et-messages-flash">ğŸ§© Partie 2.2 : Gestion des erreurs et messages flash</h2>
<p>AprÃ¨s validation, il est important de <strong>guider lâ€™utilisateur</strong> Ã  travers des messages clairs en cas dâ€™erreur ou de succÃ¨s.</p>
<hr />
<h3 id="affichage-des-erreurs-de-validation">ğŸ›‘ Affichage des erreurs de validation</h3>
<p>Laravel redirige automatiquement avec les <strong>erreurs dans la variable globale <code>$errors</code></strong>.</p>
<pre><code class="language-blade">&lt;!-- Exemple d'affichage global en haut du formulaire --&gt;
@if ($errors-&gt;any())
    &lt;div class=&quot;alert alert-danger&quot;&gt;
        &lt;ul&gt;
            @foreach ($errors-&gt;all() as $error)
                &lt;li&gt;{{ $error }}&lt;/li&gt;
            @endforeach
        &lt;/ul&gt;
    &lt;/div&gt;
@endif
</code></pre>
<hr />
<h3 id="messages-flash-de-succs">âœ… Messages flash de succÃ¨s</h3>
<p>Laravel permet dâ€™<strong>envoyer un message flash</strong> Ã  la session aprÃ¨s une action rÃ©ussie (ex. : ajout dâ€™un utilisateur).</p>
<h4 id="dans-le-contrleur-">Dans le contrÃ´leur :</h4>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="s1">'/users'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">with</span><span class="p">(</span><span class="s1">'success'</span><span class="p">,</span> <span class="s1">'Utilisateur ajoutÃ© avec succÃ¨s.'</span><span class="p">);</span>
</code></pre></div></div>
<h4 id="dans-la-vue-ex-codeusersindexbladephpcode-">Dans la vue (ex. <code>users/index.blade.php</code>) :</h4>
<pre><code class="language-blade">@if (session('success'))
    &lt;div class=&quot;alert alert-success&quot;&gt;
        {{ session('success') }}
    &lt;/div&gt;
@endif
</code></pre>
<hr />
<h3 id="bonnes-pratiques">ğŸ’¡ Bonnes pratiques</h3>
<table>
<thead>
<tr>
<th>Ã‰lÃ©ment</th>
<th>Pourquoi ?</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@error('field')</code></td>
<td>Afficher lâ€™erreur prÃ¨s du champ concernÃ©</td>
</tr>
<tr>
<td><code>old('field')</code></td>
<td>Ne pas perdre les donnÃ©es dÃ©jÃ  remplies</td>
</tr>
<tr>
<td><code>session('success')</code></td>
<td>Informer lâ€™utilisateur aprÃ¨s une action rÃ©ussie</td>
</tr>
<tr>
<td><code>session('error')</code> (option)</td>
<td>Afficher un message dâ€™Ã©chec gÃ©nÃ©ral</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="exemple-complet-avec-messages">ğŸ“Œ Exemple complet avec messages</h3>
<pre><code class="language-blade">&lt;!-- Formulaire avec messages globaux --&gt;
@if ($errors-&gt;any())
    &lt;div class=&quot;alert alert-danger&quot;&gt;
        &lt;ul&gt;
            @foreach ($errors-&gt;all() as $error)
                &lt;li&gt;{{ $error }}&lt;/li&gt;
            @endforeach
        &lt;/ul&gt;
    &lt;/div&gt;
@endif

@if (session('success'))
    &lt;div class=&quot;alert alert-success&quot;&gt;
        {{ session('success') }}
    &lt;/div&gt;
@endif

&lt;form method=&quot;POST&quot; action=&quot;/users&quot;&gt;
    @csrf

    &lt;label&gt;Nom&lt;/label&gt;
    &lt;input type=&quot;text&quot; name=&quot;name&quot; value=&quot;{{ old('name') }}&quot;&gt;
    @error('name')
        &lt;div&gt;{{ $message }}&lt;/div&gt;
    @enderror

    &lt;label&gt;Email&lt;/label&gt;
    &lt;input type=&quot;email&quot; name=&quot;email&quot; value=&quot;{{ old('email') }}&quot;&gt;
    @error('email')
        &lt;div&gt;{{ $message }}&lt;/div&gt;
    @enderror

    &lt;button type=&quot;submit&quot;&gt;Ajouter&lt;/button&gt;
&lt;/form&gt;
</code></pre>
<hr />
<blockquote>
<p>ğŸ§  Astuce : Tu peux styliser ces messages avec Tailwind (<code>bg-red-100</code>, <code>text-green-600</code>) ou Bootstrap (<code>alert alert-danger</code>, <code>alert-success</code>) selon ton framework CSS.</p>
</blockquote>
<h2 id="partie-23--authentification-avec-laravel-breeze">ğŸ” Partie 2.3 : Authentification avec Laravel Breeze</h2>
<p>Laravel propose plusieurs solutions dâ€™authentification clÃ© en main. La plus simple pour dÃ©marrer est <strong>Laravel Breeze</strong>.</p>
<hr />
<h3 id="installation-de-breeze">ğŸš€ Installation de Breeze</h3>
<p>Installe le package via Composer :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>composer require laravel/breeze <span class="nt">--dev</span>
</code></pre></div></div>
<p>GÃ©nÃ¨re les fichiers nÃ©cessaires :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php artisan breeze:install
</code></pre></div></div>
<p>Installe les dÃ©pendances front-end et compile :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="o">&amp;&amp;</span> npm run dev
</code></pre></div></div>
<p>Lance la migration pour crÃ©er les tables des utilisateurs :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php artisan migrate
</code></pre></div></div>
<hr />
<h3 id="ce-que-breeze-installe-pour-toi">ğŸ§ª Ce que Breeze installe pour toi</h3>
<ul>
<li>Routes dâ€™authentification (<code>/login</code>, <code>/register</code>, <code>/logout</code>, etc.)</li>
<li>ContrÃ´leurs pour gÃ©rer lâ€™authentification</li>
<li>Vues Blade (ou Inertia/Vue selon lâ€™option choisie)</li>
<li>Middleware <code>auth</code> pour sÃ©curiser les routes</li>
</ul>
<hr />
<h3 id="exemple-dutilisation">ğŸ§­ Exemple dâ€™utilisation</h3>
<h4 id="protger-une-route-avec-lauthentification-">ProtÃ©ger une route avec lâ€™authentification :</h4>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// routes/web.php</span>

<span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/dashboard'</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nf">view</span><span class="p">(</span><span class="s1">'dashboard'</span><span class="p">);</span>
<span class="p">})</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">([</span><span class="s1">'auth'</span><span class="p">]);</span>
</code></pre></div></div>
<h4 id="rediriger-lutilisateur-connect-">Rediriger lâ€™utilisateur connectÃ© :</h4>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">Illuminate\Support\Facades\Auth</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nc">Auth</span><span class="o">::</span><span class="nf">check</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="s1">'/dashboard'</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<hr />
<h3 id="exemple--afficher-le-nom-de-lutilisateur-connect">ğŸ§© Exemple : Afficher le nom de l'utilisateur connectÃ©</h3>
<pre><code class="language-blade">&lt;!-- resources/views/dashboard.blade.php --&gt;

&lt;h1&gt;Bienvenue {{ Auth::user()-&gt;name }} !&lt;/h1&gt;
&lt;a href=&quot;{{ route('logout') }}&quot;&gt;Se dÃ©connecter&lt;/a&gt;
</code></pre>
<hr />
<h3 id="bonus--liens-utiles">âœ¨ Bonus : Liens utiles</h3>
<ul>
<li>Laravel Breeze : <a href="https://laravel.com/docs/breeze">laravel.com/docs/breeze</a></li>
<li>Authentification avancÃ©e : Laravel Jetstream ou Laravel Fortify</li>
</ul>
<hr />
<blockquote>
<p>âœ… Laravel Breeze est idÃ©al pour les projets simples ou pour apprendre lâ€™authentification dans Laravel.</p>
</blockquote>
<h2 id="partie-24--gestion-des-rles-et-permissions-avec-laravel">ğŸ›¡ï¸ Partie 2.4 : Gestion des rÃ´les et permissions avec Laravel</h2>
<p>Pour gÃ©rer les rÃ´les (ex. : admin, utilisateur) et les permissions, il est recommandÃ© dâ€™utiliser un package comme <strong>Spatie Laravel Permission</strong>.</p>
<hr />
<h3 id="installation-du-package">ğŸš€ Installation du package</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>composer require spatie/laravel-permission
</code></pre></div></div>
<p>Publie la configuration et les migrations :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php artisan vendor:publish <span class="nt">--provider</span><span class="o">=</span><span class="s2">"Spatie</span><span class="se">\P</span><span class="s2">ermission</span><span class="se">\P</span><span class="s2">ermissionServiceProvider"</span>
php artisan migrate
</code></pre></div></div>
<hr />
<h3 id="configuration-du-modle-user">ğŸ”§ Configuration du modÃ¨le User</h3>
<p>Modifie ton modÃ¨le <code>User</code> pour utiliser le trait fourni par Spatie :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// app/Models/User.php</span>

<span class="kn">namespace</span> <span class="nn">App\Models</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Illuminate\Foundation\Auth\User</span> <span class="k">as</span> <span class="nc">Authenticatable</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Spatie\Permission\Traits\HasRoles</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">User</span> <span class="kd">extends</span> <span class="nc">Authenticatable</span>
<span class="p">{</span>
    <span class="kn">use</span> <span class="nc">HasRoles</span><span class="p">;</span>

    <span class="c1">// autres propriÃ©tÃ©s et mÃ©thodes</span>
<span class="p">}</span>
</code></pre></div></div>
<hr />
<h3 id="cration-des-rles-et-assignation">âš™ï¸ CrÃ©ation des rÃ´les et assignation</h3>
<p>Tu peux crÃ©er des rÃ´les et permissions dans un Seeder ou via un script :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">Spatie\Permission\Models\Role</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Spatie\Permission\Models\Permission</span><span class="p">;</span>

<span class="c1">// CrÃ©ation de rÃ´les</span>
<span class="nv">$adminRole</span> <span class="o">=</span> <span class="nc">Role</span><span class="o">::</span><span class="nf">create</span><span class="p">([</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'admin'</span><span class="p">]);</span>
<span class="nv">$userRole</span> <span class="o">=</span> <span class="nc">Role</span><span class="o">::</span><span class="nf">create</span><span class="p">([</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'user'</span><span class="p">]);</span>

<span class="c1">// CrÃ©ation de permissions</span>
<span class="nv">$editArticles</span> <span class="o">=</span> <span class="nc">Permission</span><span class="o">::</span><span class="nf">create</span><span class="p">([</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'edit articles'</span><span class="p">]);</span>
<span class="nv">$deleteArticles</span> <span class="o">=</span> <span class="nc">Permission</span><span class="o">::</span><span class="nf">create</span><span class="p">([</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'delete articles'</span><span class="p">]);</span>

<span class="c1">// Assignation de permissions Ã  un rÃ´le</span>
<span class="nv">$adminRole</span><span class="o">-&gt;</span><span class="nf">givePermissionTo</span><span class="p">(</span><span class="nv">$editArticles</span><span class="p">);</span>
<span class="nv">$adminRole</span><span class="o">-&gt;</span><span class="nf">givePermissionTo</span><span class="p">(</span><span class="nv">$deleteArticles</span><span class="p">);</span>

<span class="c1">// Assignation dâ€™un rÃ´le Ã  un utilisateur</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">::</span><span class="nf">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="nf">assignRole</span><span class="p">(</span><span class="s1">'admin'</span><span class="p">);</span>
</code></pre></div></div>
<hr />
<h3 id="protection-des-routes-selon-rlepermission">ğŸ” Protection des routes selon rÃ´le/permission</h3>
<p>Tu peux protÃ©ger les routes ainsi :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Route</span><span class="o">::</span><span class="nf">group</span><span class="p">([</span><span class="s1">'middleware'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'role:admin'</span><span class="p">]],</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/admin'</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nf">view</span><span class="p">(</span><span class="s1">'admin.dashboard'</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>

<span class="nc">Route</span><span class="o">::</span><span class="nf">group</span><span class="p">([</span><span class="s1">'middleware'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'permission:edit articles'</span><span class="p">]],</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/articles/edit'</span><span class="p">,</span> <span class="s1">'ArticleController@edit'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>
<hr />
<h3 id="vrifications-dans-les-vues-blade">ğŸ‘€ VÃ©rifications dans les vues Blade</h3>
<pre><code class="language-blade">@role('admin')
    &lt;p&gt;Contenu rÃ©servÃ© aux administrateurs&lt;/p&gt;
@endrole

@can('edit articles')
    &lt;button&gt;Modifier un article&lt;/button&gt;
@endcan
</code></pre>
<hr />
<h3 id="documentation-officielle">ğŸ“š Documentation officielle</h3>
<ul>
<li><a href="https://spatie.be/docs/laravel-permission/v5/introduction">Spatie Laravel Permission</a></li>
<li><a href="https://laravel.com/docs/middleware">Middleware Laravel</a></li>
<li><a href="https://laravel.com/docs/blade#roles-and-permissions">Blade Directives</a></li>
</ul>
<hr />
<blockquote>
<p>âœ… Cette mÃ©thode est robuste et largement utilisÃ©e dans la communautÃ© Laravel pour gÃ©rer les autorisations avancÃ©es.</p>
</blockquote>
<h3 id="exercice-25--formulaire-scuris">Exercice 2.5 : Formulaire sÃ©curisÃ©</h3>
<p>Ã€ vous de jouer <a href="/php/exercises/exercices-advanced2.1.html">Exercices</a></p>
<hr />
<h1 id="partie-3--api-rest-et-tests-avec-phpunit">Partie 3 : API REST et tests avec PHPUnit</h1>
<h2 id="quest-ce-quune-api-">Quâ€™est-ce quâ€™une API ?</h2>
<p><strong>API</strong> signifie <em>Application Programming Interface</em> (Interface de Programmation Applicative).<br />
Câ€™est un ensemble de rÃ¨gles qui permet Ã  des applications diffÃ©rentes de communiquer entre elles.</p>
<ul>
<li>Imagine une API comme un <strong>serveur</strong> qui reÃ§oit des requÃªtes (demandes) et renvoie des rÃ©ponses.</li>
<li>Par exemple, une application mobile mÃ©tÃ©o demande la mÃ©tÃ©o Ã  un serveur via une API, et reÃ§oit les donnÃ©es en retour.</li>
</ul>
<h3 id="pourquoi-utiliser-une-api-">Pourquoi utiliser une API ?</h3>
<ul>
<li><strong>SÃ©paration des responsabilitÃ©s</strong> : Le backend (serveur) gÃ¨re les donnÃ©es, le frontend (interface utilisateur) affiche ces donnÃ©es.</li>
<li><strong>InteropÃ©rabilitÃ©</strong> : DiffÃ©rents clients (applications web, mobiles, autres serveurs) peuvent utiliser la mÃªme API.</li>
<li><strong>FlexibilitÃ©</strong> : Le backend peut Ã©voluer indÃ©pendamment de lâ€™interface utilisateur.</li>
</ul>
<hr />
<h2 id="les-api-rest">Les API REST</h2>
<p><strong>REST</strong> (Representational State Transfer) est un style dâ€™architecture pour construire des API.</p>
<p>Les principes clÃ©s de REST sont :</p>
<ul>
<li>
<p>Utiliser les <strong>mÃ©thodes HTTP</strong> pour indiquer lâ€™action Ã  faire :</p>
<ul>
<li><code>GET</code> : rÃ©cupÃ©rer des donnÃ©es</li>
<li><code>POST</code> : crÃ©er des donnÃ©es</li>
<li><code>PUT</code> / <code>PATCH</code> : modifier des donnÃ©es</li>
<li><code>DELETE</code> : supprimer des donnÃ©es</li>
</ul>
</li>
<li>
<p>Avoir des <strong>URL claires</strong> reprÃ©sentant les ressources, par exemple <code>/users</code> pour accÃ©der aux utilisateurs.</p>
</li>
<li>
<p>Utiliser le format <strong>JSON</strong> pour Ã©changer les donnÃ©es, car il est lÃ©ger et facile Ã  lire.</p>
</li>
</ul>
<hr />
<h2 id="exemple--crer-une-api-rest-avec-laravel">Exemple : crÃ©er une API REST avec Laravel</h2>
<h3 id="dfinir-les-routes-api">1. DÃ©finir les routes API</h3>
<p>Dans Laravel, les routes pour lâ€™API sont dÃ©finies dans <code>routes/api.php</code>.<br />
Exemple :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">App\Http\Controllers\UserController</span><span class="p">;</span>

<span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/users'</span><span class="p">,</span> <span class="p">[</span><span class="nc">UserController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'index'</span><span class="p">]);</span> <span class="c1">// Liste tous les utilisateurs</span>
<span class="nc">Route</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s1">'/users'</span><span class="p">,</span> <span class="p">[</span><span class="nc">UserController</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="s1">'store'</span><span class="p">]);</span> <span class="c1">// CrÃ©e un nouvel utilisateur</span>
</code></pre></div></div>
<h3 id="contrleur-pour-grer-les-requtes">2. ContrÃ´leur pour gÃ©rer les requÃªtes</h3>
<p>Dans <code>app/Http/Controllers/UserController.php</code>, on Ã©crit les fonctions pour rÃ©pondre Ã  ces requÃªtes :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">namespace</span> <span class="nn">App\Http\Controllers</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">App\Models\User</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Illuminate\Http\JsonResponse</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Illuminate\Http\Request</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">UserController</span> <span class="kd">extends</span> <span class="nc">Controller</span>
<span class="p">{</span>
    <span class="c1">// Retourne tous les utilisateurs en JSON</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">index</span><span class="p">():</span> <span class="kt">JsonResponse</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">(</span><span class="nc">User</span><span class="o">::</span><span class="nf">all</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="c1">// CrÃ©e un nouvel utilisateur avec les donnÃ©es reÃ§ues</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">store</span><span class="p">(</span><span class="kt">Request</span> <span class="nv">$request</span><span class="p">):</span> <span class="kt">JsonResponse</span>
    <span class="p">{</span>
        <span class="nv">$validated</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">validate</span><span class="p">([</span>
            <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required|string|max:255'</span><span class="p">,</span>
            <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'required|email|unique:users,email'</span><span class="p">,</span>
        <span class="p">]);</span>

        <span class="nv">$user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">::</span><span class="nf">create</span><span class="p">(</span><span class="nv">$validated</span><span class="p">);</span>

        <span class="k">return</span> <span class="nf">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">json</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span> <span class="mi">201</span><span class="p">);</span> <span class="c1">// Code 201 = crÃ©Ã©</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h3 id="tester-lapi">Tester l'API</h3>
<p>Vous pouvez tester votre API avec :</p>
<ul>
<li>Postman : un outil graphique pour envoyer des requÃªtes HTTP</li>
<li>curl (ligne de commande) :</li>
</ul>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl http://localhost:8000/api/users
</code></pre></div></div>
<p>Cette commande envoie une requÃªte GET pour rÃ©cupÃ©rer la liste des utilisateurs.</p>
<h3 id="rsum">RÃ©sumÃ©</h3>
<ul>
<li>Une API REST permet Ã  diffÃ©rentes applications dâ€™Ã©changer des donnÃ©es via des requÃªtes HTTP.</li>
<li>Laravel facilite la crÃ©ation dâ€™API avec des routes, contrÃ´leurs et modÃ¨les.</li>
<li>Les donnÃ©es sont souvent Ã©changÃ©es en JSON.</li>
<li>Tester avec Postman ou curl est essentiel pour vÃ©rifier que lâ€™API fonctionne bien.</li>
</ul>
<h3 id="bonus--pourquoi-scuriser-une-api-">Bonus : Pourquoi sÃ©curiser une API ?</h3>
<p>Une API ouverte sans protection peut Ãªtre utilisÃ©e abusivement.
Laravel propose des mÃ©canismes comme :</p>
<ul>
<li>Authentification (ex : tokens JWT, OAuth)</li>
<li>Validation des donnÃ©es pour Ã©viter les erreurs ou injections malveillantes</li>
</ul>
<h3 id="exercice-31-">Exercice 3.1 :</h3>
<p>Ã€ vous de jouer <a href="/php/exercises/exercices-advanced2.1.html">Exercices</a></p>
<hr />
<h1 id="partie-4--tests-automatiss-avec-phpunit">Partie 4 : Tests automatisÃ©s avec PHPUnit</h1>
<h2 id="pourquoi-tester-une-api-">Pourquoi tester une API ?</h2>
<ul>
<li><strong>Assurer la qualitÃ©</strong> : VÃ©rifier que lâ€™API fonctionne correctement et retourne les bonnes donnÃ©es.</li>
<li><strong>Ã‰viter les rÃ©gressions</strong> : Si tu modifies le code, les tests te disent si quelque chose casse.</li>
<li><strong>Faciliter le dÃ©veloppement</strong> : Tests automatisÃ©s = gain de temps, plus besoin de tester manuellement.</li>
</ul>
<hr />
<h2 id="phpunit-dans-laravel">PHPUnit dans Laravel</h2>
<p>Laravel utilise <strong>PHPUnit</strong>, un framework de test pour PHP, intÃ©grÃ© et configurÃ© par dÃ©faut.</p>
<h3 id="o-crire-les-tests-">OÃ¹ Ã©crire les tests ?</h3>
<ul>
<li>Dans le dossier <code>tests/Feature</code> pour tester des fonctionnalitÃ©s (ex : routes, API)</li>
<li>Dans le dossier <code>tests/Unit</code> pour tester des unitÃ©s de code plus petites (ex : mÃ©thodes, classes)</li>
</ul>
<hr />
<h2 id="exemple--tester-lapi-users">Exemple : Tester lâ€™API users</h2>
<p>CrÃ©e un fichier <code>tests/Feature/UserTest.php</code> :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">namespace</span> <span class="nn">Tests\Feature</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Illuminate\Foundation\Testing\RefreshDatabase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Tests\TestCase</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">App\Models\User</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">UserTest</span> <span class="kd">extends</span> <span class="nc">TestCase</span>
<span class="p">{</span>
    <span class="kn">use</span> <span class="nc">RefreshDatabase</span><span class="p">;</span> <span class="c1">// RafraÃ®chit la base de donnÃ©es pour chaque test</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">test_can_list_users</span><span class="p">():</span> <span class="kt">void</span>
    <span class="p">{</span>
        <span class="c1">// CrÃ©e 3 utilisateurs en base de donnÃ©es</span>
        <span class="nc">User</span><span class="o">::</span><span class="nf">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="nb">count</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">create</span><span class="p">();</span>

        <span class="c1">// Envoie une requÃªte GET Ã  lâ€™API users</span>
        <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/api/users'</span><span class="p">);</span>

        <span class="c1">// VÃ©rifie que la rÃ©ponse HTTP est 200 (OK)</span>
        <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">assertStatus</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
                <span class="c1">// VÃ©rifie quâ€™il y a bien 3 Ã©lÃ©ments dans la rÃ©ponse JSON</span>
                <span class="o">-&gt;</span><span class="nf">assertJsonCount</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h3 id="explications">Explications</h3>
<ul>
<li><code>use RefreshDatabase</code> : Laravel vide la base de donnÃ©es avant chaque test pour un environnement propre.</li>
<li><code>User::factory()-&gt;count(3)-&gt;create()</code> : crÃ©e 3 utilisateurs fictifs avec les donnÃ©es par dÃ©faut.</li>
<li><code>$this-&gt;get('/api/users')</code> : simule une requÃªte HTTP GET vers <code>/api/users</code>.</li>
<li><code>assertStatus(200)</code> : vÃ©rifie que la requÃªte a rÃ©ussi (code 200).</li>
<li><code>assertJsonCount(3)</code> : vÃ©rifie que la rÃ©ponse JSON contient exactement 3 Ã©lÃ©ments.</li>
</ul>
<h3 id="configurer-la-base-de-donnes-pour-les-tests">Configurer la base de donnÃ©es pour les tests</h3>
<ol>
<li>CrÃ©e une base SQLite pour les tests (fichier <code>database/database.sqlite</code>) :</li>
</ol>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">touch </span>database/database.sqlite
</code></pre></div></div>
<ol start="2">
<li>Dans le fichier <code>.env.testing</code> (ou <code>.env</code> si tu testes directement), configure la base de donnÃ©es :</li>
</ol>
<pre><code class="language-env">DB_CONNECTION=sqlite
DB_DATABASE=/full/path/to/database/database.sqlite
</code></pre>
<h3 id="lancer-les-test">Lancer les test</h3>
<p>Pour exÃ©cuter tous les tests, lance la commande :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php artisan <span class="nb">test</span>
</code></pre></div></div>
<p>Ou directement PHPUnit:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vendor/bin/phpunit
</code></pre></div></div>
<p>Laravel affichera un rapport des tests passÃ©s ou Ã©chouÃ©s.</p>
<h3 id="pourquoi-crire-des-tests-">Pourquoi Ã©crire des tests ?</h3>
<ul>
<li>Tu gagnes en confiance lors des modifications</li>
<li>Tu dÃ©tectes rapidement les bugs</li>
<li>Tu peux automatiser ces tests dans un systÃ¨me dâ€™intÃ©gration continue (CI/CD)</li>
</ul>
<p>Ã€ vous de jouer <a href="/php/exercises/exercices-advanced3.1.html">Exercices</a></p>
<hr />
<h1 id="partie-5--projet-en-groupe--application-de-gestion-dutilisateurs">Partie 5 : Projet en groupe â€“ Application de gestion dâ€™utilisateurs</h1>
<p><strong>Cliquez sur le lien</strong> : <a href="/php/exercises/project-advanced.html">Projet</a></p>
<hr />
<p><a href="/index.html">retour</a></p>

    </div>
    <script src="/assets/js/dropdown.js"></script>
</body>

</html>